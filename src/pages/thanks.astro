---
import Layout from "../components/Layout.astro";
import beans from "../data/beans.json";

const beanIds = beans.map((bean) => bean.id);
---

<Layout title="주문 완료 · coffee bar" description="주문이 접수되었습니다">
  <section class="sticker-card text-center">
    <p class="sticker-chip inline-flex">ORDER RECEIVED</p>
    <h1 class="mt-3 text-3xl font-bold text-roast">접수됐습니다!</h1>
    <p class="mt-3 text-sm text-ink/85">커피가 준비되는 동안, 읽을 거리를 마련해 두었습니다.</p>

    <div class="mt-6 space-y-2">
      <a
        id="story-cta"
        href="/story"
        class="touch-target inline-flex w-full items-center justify-center rounded-xl bg-roast px-4 py-3.5 text-base font-bold text-paper"
      >
        커피 이야기 읽기
      </a>
      <a
        id="ordered-bean-cta"
        href="/beans"
        class="touch-target inline-flex w-full items-center justify-center rounded-xl border border-roast/30 bg-paper px-4 py-3 text-sm font-bold text-roast"
      >
        주문한 원두 알아보기
      </a>
      <a href="/beans" class="inline-flex items-center justify-center pt-1 text-xs font-semibold text-roast/80 underline decoration-roast/30 underline-offset-4">
        다른 원두 구경하기
      </a>
    </div>
  </section>

  <script is:inline>
    const validBeanIds = new Set({JSON.stringify(beanIds)});
    const params = new URLSearchParams(window.location.search);
    const beanId = params.get("bean");

    if (beanId && validBeanIds.has(beanId)) {
      const storyCta = document.getElementById("story-cta");
      const orderedBeanCta = document.getElementById("ordered-bean-cta");

      if (storyCta) {
        storyCta.setAttribute("href", `/story?bean=${beanId}`);
      }

      if (orderedBeanCta) {
        orderedBeanCta.setAttribute("href", `/beans/${beanId}`);
      }
    }
  </script>
</Layout>
